(self.webpackChunkotomi_docs=self.webpackChunkotomi_docs||[]).push([[4548],{3905:function(e,t,r){"use strict";r.d(t,{Zo:function(){return u},kt:function(){return m}});var n=r(7294);function a(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function o(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function i(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?o(Object(r),!0).forEach((function(t){a(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):o(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function s(e,t){if(null==e)return{};var r,n,a=function(e,t){if(null==e)return{};var r,n,a={},o=Object.keys(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||(a[r]=e[r]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}var c=n.createContext({}),l=function(e){var t=n.useContext(c),r=t;return e&&(r="function"==typeof e?e(t):i(i({},t),e)),r},u=function(e){var t=l(e.components);return n.createElement(c.Provider,{value:t},e.children)},p={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},d=n.forwardRef((function(e,t){var r=e.components,a=e.mdxType,o=e.originalType,c=e.parentName,u=s(e,["components","mdxType","originalType","parentName"]),d=l(r),m=a,f=d["".concat(c,".").concat(m)]||d[m]||p[m]||o;return r?n.createElement(f,i(i({ref:t},u),{},{components:r})):n.createElement(f,i({ref:t},u))}));function m(e,t){var r=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var o=r.length,i=new Array(o);i[0]=d;var s={};for(var c in t)hasOwnProperty.call(t,c)&&(s[c]=t[c]);s.originalType=e,s.mdxType="string"==typeof e?e:a,i[1]=s;for(var l=2;l<o;l++)i[l]=r[l];return n.createElement.apply(null,i)}return n.createElement.apply(null,r)}d.displayName="MDXCreateElement"},912:function(e,t,r){"use strict";r.r(t),r.d(t,{frontMatter:function(){return s},metadata:function(){return c},toc:function(){return l},default:function(){return p}});var n=r(2122),a=r(9756),o=(r(7294),r(3905)),i=["components"],s={slug:"ee/secrets",title:"Secrets"},c={unversionedId:"ee-configuring-secrets",id:"ee-configuring-secrets",isDocsHomePage:!1,title:"Secrets",description:"This page describes how to create a secret, and how to edit a secret. Both creating and editing a secret use the same form.",source:"@site/docs/ee-configuring-secrets.md",sourceDirName:".",slug:"/ee/secrets",permalink:"/docs/ee/secrets",editUrl:"https://github.com/redkubes/redkubes/tree/master/docs/ee-configuring-secrets.md",version:"current",frontMatter:{slug:"ee/secrets",title:"Secrets"},sidebar:"mainSidebar",previous:{title:"Jobs",permalink:"/docs/ee/jobs"},next:{title:"Team Apps",permalink:"/docs/ee/team-apps"}},l=[{value:"Type",id:"type",children:[{value:"1. Generic",id:"1-generic",children:[]},{value:"2. Docker Registry",id:"2-docker-registry",children:[]},{value:"3. TLS",id:"3-tls",children:[]}]}],u={toc:l};function p(e){var t=e.components,s=(0,a.Z)(e,i);return(0,o.kt)("wrapper",(0,n.Z)({},u,s,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("p",null,"This page describes how to create a secret, and how to edit a secret. Both creating and editing a secret use the same form."),(0,o.kt)("p",null,"Any secret that is created here should have it's counterpart in Vault by the same name. Otomi will create kubernetes secrets from those Vault secrets. These can then be registered in services or jobs, as injected env vars, or file mounts."),(0,o.kt)("p",null,"Screenshot (admin role):"),(0,o.kt)("p",null,(0,o.kt)("img",{alt:"Console: new secret",src:r(2123).Z})),(0,o.kt)("h2",{id:"type"},"Type"),(0,o.kt)("p",null,"What type of secret to deploy/expose. Three options exist:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"#1-generic"},"1. Generic")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"#2-docker-registry"},"2. Docker Registry")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"#3-tls"},"3. TLS"))),(0,o.kt)("h3",{id:"1-generic"},"1. Generic"),(0,o.kt)("p",null,"Deploy a generic kubernetes secret by listing a selection of (or all) properties of a vault secret registered with the same name."),(0,o.kt)("h3",{id:"2-docker-registry"},"2. Docker Registry"),(0,o.kt)("p",null,'Deploy a docker registry secret. It should exist in Vault as a secret with the same name. The vault secret should be of type "json" and have only one property ',(0,o.kt)("inlineCode",{parentName:"p"},".dockerconfigjson")," that is set to the value of the following command:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},'email="not@us.ed" # can be something else if the registry provider expects it, but usually this is ignored\nserver="" # example: "https://harbor.demo.eks.otomi.cloud/"\nusername="" # your username\npassword="" # your password, can be token\nkubectl create secret docker-registry --dry-run=client regcred --docker-email=$email --docker-server=$server --docker-username=$username --docker-password=$password -ojsonpath=\'{.data.\\.dockerconfigjson}\' | base64 --decode\n')),(0,o.kt)("h3",{id:"3-tls"},"3. TLS"),(0,o.kt)("p",null,'Deploy a kubernetes TLS secret. The three fields here should correspond with the properties as named in the vault secret registered with the same name. The "ca" field is optional and can be used to provide the certicate authority (for mTLS).'),(0,o.kt)("table",null,(0,o.kt)("thead",{parentName:"table"},(0,o.kt)("tr",{parentName:"thead"},(0,o.kt)("th",{parentName:"tr",align:null},"Setting"),(0,o.kt)("th",{parentName:"tr",align:null},"Description"))),(0,o.kt)("tbody",{parentName:"table"},(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},"crt"),(0,o.kt)("td",{parentName:"tr",align:null},"The PEM encoded public key certificate content")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},"key"),(0,o.kt)("td",{parentName:"tr",align:null},"The private key certificate content")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},"ca"),(0,o.kt)("td",{parentName:"tr",align:null},"The CA certificate content (optional)")))))}p.isMDXComponent=!0},2123:function(e,t,r){"use strict";t.Z=r.p+"assets/images/console-new-secret-28ef3293af5eaffddf9e46024686b742.png"}}]);