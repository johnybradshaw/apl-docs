"use strict";(self.webpackChunkredkubes_github_io=self.webpackChunkredkubes_github_io||[]).push([[7097],{3905:(e,t,a)=>{a.d(t,{Zo:()=>u,kt:()=>m});var n=a(7294);function r(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function i(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function l(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?i(Object(a),!0).forEach((function(t){r(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):i(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function o(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},i=Object.keys(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var s=n.createContext({}),c=function(e){var t=n.useContext(s),a=t;return e&&(a="function"==typeof e?e(t):l(l({},t),e)),a},u=function(e){var t=c(e.components);return n.createElement(s.Provider,{value:t},e.children)},p={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},d=n.forwardRef((function(e,t){var a=e.components,r=e.mdxType,i=e.originalType,s=e.parentName,u=o(e,["components","mdxType","originalType","parentName"]),d=c(a),m=r,f=d["".concat(s,".").concat(m)]||d[m]||p[m]||i;return a?n.createElement(f,l(l({ref:t},u),{},{components:a})):n.createElement(f,l({ref:t},u))}));function m(e,t){var a=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var i=a.length,l=new Array(i);l[0]=d;var o={};for(var s in t)hasOwnProperty.call(t,s)&&(o[s]=t[s]);o.originalType=e,o.mdxType="string"==typeof e?e:r,l[1]=o;for(var c=2;c<i;c++)l[c]=a[c];return n.createElement.apply(null,l)}return n.createElement.apply(null,a)}d.displayName="MDXCreateElement"},3223:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>s,contentTitle:()=>l,default:()=>p,frontMatter:()=>i,metadata:()=>o,toc:()=>c});var n=a(7462),r=(a(7294),a(3905));const i={slug:"lab-8",title:"Create secrets",sidebar_label:"Create secrets"},l=void 0,o={unversionedId:"for-devs/get-started/lab-8",id:"for-devs/get-started/lab-8",title:"Create secrets",description:"Hashicorp Vault needs to be activated for this lab.",source:"@site/docs/for-devs/get-started/lab-8.md",sourceDirName:"for-devs/get-started",slug:"/for-devs/get-started/lab-8",permalink:"/docs/for-devs/get-started/lab-8",draft:!1,editUrl:"https://github.com/redkubes/redkubes.github.io/tree/main/docs/for-devs/get-started/lab-8.md",tags:[],version:"current",frontMatter:{slug:"lab-8",title:"Create secrets",sidebar_label:"Create secrets"},sidebar:"mainSidebar",previous:{title:"Trigger builds",permalink:"/docs/for-devs/get-started/lab-26"},next:{title:"BYO manifests",permalink:"/docs/for-devs/get-started/lab-10"}},s={},c=[{value:"Create a secret in Vault",id:"create-a-secret-in-vault",level:2},{value:"Create a secret in Otomi",id:"create-a-secret-in-otomi",level:2}],u={toc:c};function p(e){let{components:t,...i}=e;return(0,r.kt)("wrapper",(0,n.Z)({},u,i,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("admonition",{type:"info"},(0,r.kt)("p",{parentName:"admonition"},"Hashicorp Vault needs to be activated for this lab.")),(0,r.kt)("admonition",{type:"note"},(0,r.kt)("p",{parentName:"admonition"},"Hashicorp Vault is being deprecated in Otomi. We are going to replace this app with solution based on SealedSecrets.")),(0,r.kt)("p",null,"When the platform administrator has enabled Vault, you can use Vault to store and manage secrets. Secrets in Vault can be synchronized to your team namespace as Kubernetes secrets. In this part we'll first create a secret in Vault and then sync the secret to your team namespace using the Secrets option in Otomi Console."),(0,r.kt)("h2",{id:"create-a-secret-in-vault"},"Create a secret in Vault"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Open the Vault app in your team apps")),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"kubecfg",src:a(9020).Z,width:"2900",height:"1904"})),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Sign in with Method ",(0,r.kt)("inlineCode",{parentName:"li"},"OIDC"),", click on ",(0,r.kt)("inlineCode",{parentName:"li"},"Sign in with OIDC Provider")," and leave role blank")),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"kubecfg",src:a(7953).Z,width:"1700",height:"910"})),(0,r.kt)("p",null,"You are now automatically redirected to your team space (secrets/teams/team-labs) in Vault."),(0,r.kt)("admonition",{type:"info"},(0,r.kt)("p",{parentName:"admonition"},"In your team space in Vault you will see the secret ",(0,r.kt)("inlineCode",{parentName:"p"},".keep-me"),". Do NOT remove this secrets. If you do, the team space in Vault will be removed.")),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Click on Create secret")),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"kubecfg",src:a(1).Z,width:"2904",height:"900"})),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Provide a name for the secret. We'll use the name hello. The name of the secret in this case will be: ",(0,r.kt)("inlineCode",{parentName:"li"},"teams/team-labs/hello")),(0,r.kt)("li",{parentName:"ul"},"Fill in a ",(0,r.kt)("inlineCode",{parentName:"li"},"Key")," (TARGET in the example below) and a ",(0,r.kt)("inlineCode",{parentName:"li"},"value")),(0,r.kt)("li",{parentName:"ul"},"Click on save")),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"kubecfg",src:a(4435).Z,width:"2904",height:"1064"})),(0,r.kt)("p",null,"The secret is now created in vault. Now we need to synchronize the secret in Vault to Kubernetes so the secret can be used in workloads."),(0,r.kt)("h2",{id:"create-a-secret-in-otomi"},"Create a secret in Otomi"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"In the left menu click Secrets"),(0,r.kt)("li",{parentName:"ul"},"Click on Create secret"),(0,r.kt)("li",{parentName:"ul"},"Provide a name for the secret. The name should match the name of the secret in Vault"),(0,r.kt)("li",{parentName:"ul"},"Select the secret type (Generic in this case)"),(0,r.kt)("li",{parentName:"ul"},"Under Entries fill in the ",(0,r.kt)("inlineCode",{parentName:"li"},"keys")," (the keys of the secret in Vault)")),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"kubecfg",src:a(7705).Z,width:"2904",height:"1920"})),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Click submit"),(0,r.kt)("li",{parentName:"ul"},"Now click on ",(0,r.kt)("inlineCode",{parentName:"li"},"Deploy Changes")," on top of the left menu")),(0,r.kt)("p",null,"The secret in Vault will now be synchronized to Kubernetes and can be used by the team in any workload. Otomi Console makes this easy by offering a secret selector during the creation of services."),(0,r.kt)("admonition",{type:"info"},(0,r.kt)("p",{parentName:"admonition"},"In this lab we only covered using generic secrets. See ",(0,r.kt)("a",{parentName:"p",href:"/docs/for-devs/console/secrets"},"here")," to see how you can create TLS and pull secrets")))}p.isMDXComponent=!0},7705:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/create-secret-2-ab8db511bd71993615ddc85bde5f5d58.png"},4435:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/create-secret-vault-2-c648e3cb5e181d218edef5f70047ae2d.png"},1:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/create-secret-vault-442c744f3ca6f1c13a8c1c82a646ecc9.png"},9020:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/team-vault-852bc12865e732fa96cc32e3b684588c.png"},7953:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/vault-oidc-54fbc2583484993604108a590f2fa5b8.png"}}]);