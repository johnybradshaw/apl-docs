"use strict";(self.webpackChunkredkubes_github_io=self.webpackChunkredkubes_github_io||[]).push([[4724],{3491:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>c,contentTitle:()=>i,default:()=>h,frontMatter:()=>l,metadata:()=>r,toc:()=>a});var t=s(5893),o=s(1151);const l={slug:"lab-14",title:"Deploy serverless workloads",sidebar_label:"Lab 14"},i=void 0,r={id:"get-started/labs/lab-14",title:"Deploy serverless workloads",description:"Prerequisite: For this lab, Argo CD needs to be activated.",source:"@site/docs/get-started/labs/lab-14.md",sourceDirName:"get-started/labs",slug:"/get-started/labs/lab-14",permalink:"/docs/get-started/labs/lab-14",draft:!1,unlisted:!1,editUrl:"https://github.com/redkubes/redkubes.github.io/tree/main/docs/get-started/labs/lab-14.md",tags:[],version:"current",frontMatter:{slug:"lab-14",title:"Deploy serverless workloads",sidebar_label:"Lab 14"}},c={},a=[{value:"Create a Function as a Service workload",id:"create-a-function-as-a-service-workload",level:2},{value:"(optionally) Publicly expose the service",id:"optionally-publicly-expose-the-service",level:2}];function d(e){const n={a:"a",admonition:"admonition",code:"code",h2:"h2",img:"img",li:"li",ol:"ol",p:"p",pre:"pre",ul:"ul",...(0,o.a)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.admonition,{type:"info",children:(0,t.jsx)(n.p,{children:"Prerequisite: For this lab, Argo CD needs to be activated."})}),"\n",(0,t.jsx)(n.p,{children:"Otomi uses Knative serving for serverless (or Function as a Service) support."}),"\n",(0,t.jsx)(n.p,{children:"As a developer, you'll have the following options to deploy serverless workloads:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"BYO Knative service manifest and deploy it using kubectl or ArgoCD"}),"\n",(0,t.jsxs)(n.li,{children:["Create workloads with the deployment Helm chart in ",(0,t.jsx)(n.code,{children:"otomi-charts"})]}),"\n",(0,t.jsxs)(n.li,{children:["Create workloads with the Knative Helm chart in ",(0,t.jsx)(n.code,{children:"otomi-charts"})]}),"\n"]}),"\n",(0,t.jsxs)(n.p,{children:["In this lab we're going to create a workload in Otomi to create a Knative service using the knative chart in ",(0,t.jsx)(n.code,{children:"otomi-charts"}),"."]}),"\n",(0,t.jsx)(n.h2,{id:"create-a-function-as-a-service-workload",children:"Create a Function as a Service workload"}),"\n",(0,t.jsxs)(n.p,{children:["You can create a workload to deploy your own Helm chart, or you can use one of the ",(0,t.jsx)(n.code,{children:"otomi-charts"})," Helm charts. In this case we'll use the deployment chart in the ",(0,t.jsx)(n.code,{children:"otomi-charts"})," repository."]}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:["Go to ",(0,t.jsx)(n.code,{children:"Workloads"})," in the left menu and click on ",(0,t.jsx)(n.code,{children:"Create Workload"})]}),"\n",(0,t.jsxs)(n.li,{children:["Choose ",(0,t.jsx)(n.code,{children:"Function as a Service"})]}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.img,{alt:"kubecfg",src:s(4943).Z+"",width:"2370",height:"626"})}),"\n",(0,t.jsxs)(n.ol,{start:"3",children:["\n",(0,t.jsx)(n.li,{children:"Enter a name for the workload"}),"\n"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"hello-ksvc\n"})}),"\n",(0,t.jsxs)(n.ol,{start:"4",children:["\n",(0,t.jsx)(n.li,{children:"Fill in the image to deploy:"}),"\n"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"otomi/nodejs-helloworld\n"})}),"\n",(0,t.jsxs)(n.ol,{start:"5",children:["\n",(0,t.jsx)(n.li,{children:"Fill in the tag of the image to deploy:"}),"\n"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"v1.2.13\n"})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.img,{alt:"kubecfg",src:s(3325).Z+"",width:"3118",height:"2846"})}),"\n",(0,t.jsx)(n.admonition,{type:"info",children:(0,t.jsxs)(n.p,{children:["Note: When creating a Function as a Service workload, the Min Instances will by default be set to ",(0,t.jsx)(n.code,{children:"0"})," to enable ",(0,t.jsx)(n.code,{children:"Scale to Zero"}),"."]})}),"\n",(0,t.jsxs)(n.ol,{start:"6",children:["\n",(0,t.jsxs)(n.li,{children:["Click ",(0,t.jsx)(n.code,{children:"Next"})]}),"\n",(0,t.jsxs)(n.li,{children:["Review the values. Here you can add more values supported by the ",(0,t.jsx)(n.a,{href:"https://github.com/redkubes/otomi-charts",children:"otomi-charts"})]}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.img,{alt:"kubecfg",src:s(9098).Z+"",width:"3116",height:"1730"})}),"\n",(0,t.jsxs)(n.ol,{start:"8",children:["\n",(0,t.jsxs)(n.li,{children:["Click ",(0,t.jsx)(n.code,{children:"Submit"})]}),"\n"]}),"\n",(0,t.jsxs)(n.p,{children:["Now click on ",(0,t.jsx)(n.code,{children:"Deploy Changes"})]}),"\n",(0,t.jsxs)(n.p,{children:["After a few minutes, Otomi will have created all the needed Argo CD resources to deploy your workload. In the workloads list, click on the ",(0,t.jsx)(n.code,{children:"Application"})," link of your workload to see the status of your workload."]}),"\n",(0,t.jsx)(n.p,{children:"The values of a workload can be changed at any time. Changes will automatically be deployed."}),"\n",(0,t.jsx)(n.h2,{id:"optionally-publicly-expose-the-service",children:"(optionally) Publicly expose the service"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["In the left menu panel under click ",(0,t.jsx)(n.code,{children:"Services"})," then click on ",(0,t.jsx)(n.code,{children:"Create Service"})]}),"\n",(0,t.jsxs)(n.li,{children:["Select the name of the (existing) knative service: ",(0,t.jsx)(n.code,{children:"hello-ksvc"})]}),"\n",(0,t.jsxs)(n.li,{children:["Under ",(0,t.jsx)(n.code,{children:"Exposure Ingress"}),", select ",(0,t.jsx)(n.code,{children:"Ingress"})," and use the default configuration"]}),"\n",(0,t.jsxs)(n.li,{children:["Click on ",(0,t.jsx)(n.code,{children:"Submit"})]}),"\n",(0,t.jsxs)(n.li,{children:["Click on ",(0,t.jsx)(n.code,{children:"Deploy Changes"})," (the Deploy Changes button in the left panel will light-up after you click on submit)."]}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,o.a)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(d,{...e})}):d(e)}},3325:(e,n,s)=>{s.d(n,{Z:()=>t});const t=s.p+"assets/images/ksvc-app-2-52fc1cc95fbc88ca2d43bdf3f09f8c9b.png"},9098:(e,n,s)=>{s.d(n,{Z:()=>t});const t=s.p+"assets/images/ksvc-app-3-7c9d602462e66749e02f23ecc5390ce7.png"},4943:(e,n,s)=>{s.d(n,{Z:()=>t});const t=s.p+"assets/images/ksvc-app-af2d38defa4e7508bec044d21de3a1a5.png"},1151:(e,n,s)=>{s.d(n,{Z:()=>r,a:()=>i});var t=s(7294);const o={},l=t.createContext(o);function i(e){const n=t.useContext(l);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function r(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:i(e.components),t.createElement(l.Provider,{value:n},e.children)}}}]);