"use strict";(self.webpackChunkredkubes_github_io=self.webpackChunkredkubes_github_io||[]).push([[8801],{5347:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>l,contentTitle:()=>o,default:()=>p,frontMatter:()=>a,metadata:()=>i,toc:()=>c});var r=n(5893),s=n(1151);const a={slug:"tutorials/create-k8s-service",title:"Create a Kubernetes service",sidebar_label:"Create a K8s service"},o=void 0,i={id:"tutorials/tutorial-create-byo-svc",title:"Create a Kubernetes service",description:"In this tutorial, we are going to deploy the image we pushed to harbor in the previous tutorial, by creating a Kubernetes Deployment and Service.",source:"@site/docs/tutorials/tutorial-create-byo-svc.md",sourceDirName:"tutorials",slug:"/tutorials/tutorials/create-k8s-service",permalink:"/docs/tutorials/tutorials/create-k8s-service",draft:!1,unlisted:!1,editUrl:"https://github.com/redkubes/redkubes.github.io/tree/main/docs/tutorials/tutorial-create-byo-svc.md",tags:[],version:"current",frontMatter:{slug:"tutorials/create-k8s-service",title:"Create a Kubernetes service",sidebar_label:"Create a K8s service"}},l={},c=[{value:"Create a Deployment and Service",id:"create-a-deployment-and-service",level:3},{value:"Deploy the deployment and service",id:"deploy-the-deployment-and-service",level:3}];function d(e){const t={code:"code",h3:"h3",p:"p",pre:"pre",...(0,s.a)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(t.p,{children:"In this tutorial, we are going to deploy the image we pushed to harbor in the previous tutorial, by creating a Kubernetes Deployment and Service."}),"\n",(0,r.jsx)(t.h3,{id:"create-a-deployment-and-service",children:"Create a Deployment and Service"}),"\n",(0,r.jsxs)(t.p,{children:["Create a ",(0,r.jsx)(t.code,{children:"hello-svc.yaml"})," file and copy/paste the following 2 Kubernetes manifests:"]}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-yaml",children:"apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: hello-svc\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: hello-svc\n  template:\n    metadata:\n      annotations:\n        policy.otomi.io/ignore-sidecar: container-limits,psp-allowed-users\n      labels:\n        app: hello-svc\n    spec:\n      containers:\n        - name: hello-svc\n          image: harbor.<your-ip>.nip.io/team-demo/hello-world:latest\n          resources:\n            limits:\n              memory: '128Mi'\n              cpu: '200m'\n            requests:\n              memory: '64Mi'\n              cpu: '100m'\n          securityContext:\n            runAsUser: 1001\n          ports:\n            - containerPort: 8080\n---\napiVersion: v1\nkind: Service\nmetadata:\n  name: hello-svc\nspec:\n  selector:\n    app: hello-svc\n  ports:\n    - port: 80\n      targetPort: 8080\n"})}),"\n",(0,r.jsx)(t.h3,{id:"deploy-the-deployment-and-service",children:"Deploy the deployment and service"}),"\n",(0,r.jsxs)(t.p,{children:["In Otomi console, select team ",(0,r.jsx)(t.code,{children:"demo"})," in the top bar. On the bottom of the left panel, click on ",(0,r.jsx)(t.code,{children:"download KUBECFG"}),"."]}),"\n",(0,r.jsx)(t.p,{children:"Now export the KUBECFG to set the kubectl context:"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-bash",children:"export KUBECONFIG=$path-to-your-kubeconfig.yaml\n"})}),"\n",(0,r.jsx)(t.p,{children:"And apply the manifest to Kubernetes:"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-bash",children:"kubectl apply -f hello-svc.yaml\n"})}),"\n",(0,r.jsx)(t.p,{children:"Check to see if the pod is running and the service has been created:"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-bash",children:"kubectl get pod\n"})}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-bash",children:"kubectl describe svc hello\n"})})]})}function p(e={}){const{wrapper:t}={...(0,s.a)(),...e.components};return t?(0,r.jsx)(t,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}},1151:(e,t,n)=>{n.d(t,{Z:()=>i,a:()=>o});var r=n(7294);const s={},a=r.createContext(s);function o(e){const t=r.useContext(a);return r.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function i(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:o(e.components),r.createElement(a.Provider,{value:t},e.children)}}}]);