"use strict";(self.webpackChunkredkubes_github_io=self.webpackChunkredkubes_github_io||[]).push([[1713],{3905:(e,t,r)=>{r.d(t,{Zo:()=>u,kt:()=>m});var a=r(7294);function n(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function o(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function s(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?o(Object(r),!0).forEach((function(t){n(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):o(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function i(e,t){if(null==e)return{};var r,a,n=function(e,t){if(null==e)return{};var r,a,n={},o=Object.keys(e);for(a=0;a<o.length;a++)r=o[a],t.indexOf(r)>=0||(n[r]=e[r]);return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)r=o[a],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}var c=a.createContext({}),l=function(e){var t=a.useContext(c),r=t;return e&&(r="function"==typeof e?e(t):s(s({},t),e)),r},u=function(e){var t=l(e.components);return a.createElement(c.Provider,{value:t},e.children)},p={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},d=a.forwardRef((function(e,t){var r=e.components,n=e.mdxType,o=e.originalType,c=e.parentName,u=i(e,["components","mdxType","originalType","parentName"]),d=l(r),m=n,h=d["".concat(c,".").concat(m)]||d[m]||p[m]||o;return r?a.createElement(h,s(s({ref:t},u),{},{components:r})):a.createElement(h,s({ref:t},u))}));function m(e,t){var r=arguments,n=t&&t.mdxType;if("string"==typeof e||n){var o=r.length,s=new Array(o);s[0]=d;var i={};for(var c in t)hasOwnProperty.call(t,c)&&(i[c]=t[c]);i.originalType=e,i.mdxType="string"==typeof e?e:n,s[1]=i;for(var l=2;l<o;l++)s[l]=r[l];return a.createElement.apply(null,s)}return a.createElement.apply(null,r)}d.displayName="MDXCreateElement"},6778:(e,t,r)=>{r.r(t),r.d(t,{assets:()=>c,contentTitle:()=>s,default:()=>p,frontMatter:()=>o,metadata:()=>i,toc:()=>l});var a=r(7462),n=(r(7294),r(3905));const o={slug:"secrets",title:"Team Secrets",sidebar_label:"Secrets"},s=void 0,i={unversionedId:"for-devs/console/secrets",id:"for-devs/console/secrets",title:"Team Secrets",description:"Any secret that is created here should have it's counterpart in Vault by the same name. Otomi will create kubernetes secrets from those Vault secrets. These can then be used in Otomi Services and Otomi Workloads, as injected env vars, or as file mounts.",source:"@site/docs/for-devs/console/secrets.md",sourceDirName:"for-devs/console",slug:"/for-devs/console/secrets",permalink:"/docs/for-devs/console/secrets",draft:!1,editUrl:"https://github.com/redkubes/redkubes.github.io/tree/main/docs/for-devs/console/secrets.md",tags:[],version:"current",frontMatter:{slug:"secrets",title:"Team Secrets",sidebar_label:"Secrets"},sidebar:"mainSidebar",previous:{title:"Services",permalink:"/docs/for-devs/console/services"},next:{title:"Shell",permalink:"/docs/for-devs/console/shell"}},c={},l=[{value:"Create a Generic secret",id:"create-a-generic-secret",level:3},{value:"Create a Docker Registry secret",id:"create-a-docker-registry-secret",level:3},{value:"Create a TLS secret",id:"create-a-tls-secret",level:3}],u={toc:l};function p(e){let{components:t,...r}=e;return(0,n.kt)("wrapper",(0,a.Z)({},u,r,{components:t,mdxType:"MDXLayout"}),(0,n.kt)("p",null,"Any secret that is created here should have it's counterpart in Vault by the same name. Otomi will create kubernetes secrets from those Vault secrets. These can then be used in Otomi Services and Otomi Workloads, as injected env vars, or as file mounts."),(0,n.kt)("p",null,"Otomi supports 3 types of secrets:"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",{parentName:"li",href:"#create-a-generic-secret"},"Create a Generic secret")),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",{parentName:"li",href:"#create-a-docker-registry-secret"},"Create a Docker Registry secret")),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",{parentName:"li",href:"#create-a-tls-secret"},"Create a TLS secret"))),(0,n.kt)("admonition",{type:"info"},(0,n.kt)("p",{parentName:"admonition"},"Ask you platform administrator to activate Hashicorp Vault to be able to use this feature.")),(0,n.kt)("h3",{id:"create-a-generic-secret"},"Create a Generic secret"),(0,n.kt)("p",null,"Create a generic kubernetes secret by listing a selection of (or all) properties of a Vault secret registered with the same name."),(0,n.kt)("h3",{id:"create-a-docker-registry-secret"},"Create a Docker Registry secret"),(0,n.kt)("p",null,'The docker registry (or pull) secret should exist in Vault as a secret with the same name. The vault secret should be of type "json" and have only one property ',(0,n.kt)("inlineCode",{parentName:"p"},".dockerconfigjson"),". Use the following command to create the json:"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-bash"},'email="not@us.ed" # can be something else if the registry provider expects it, but usually this is ignored\nserver="" # example: "https://harbor.demo.eks.otomi.cloud/"\nusername="" # your username\npassword="" # your password, can be token\nkubectl create secret docker-registry --dry-run=client regcred --docker-email=$email --docker-server=$server --docker-username=$username --docker-password=$password -o jsonpath=\'{.data.\\.dockerconfigjson}\' | base64 --decode\n')),(0,n.kt)("h3",{id:"create-a-tls-secret"},"Create a TLS secret"),(0,n.kt)("p",null,'To create a TLS secret, the fields should correspond with the properties as named in the Vault secret registered with the same name. The "ca" field is optional and can be used to provide the certificate authority (for mTLS).'),(0,n.kt)("table",null,(0,n.kt)("thead",{parentName:"table"},(0,n.kt)("tr",{parentName:"thead"},(0,n.kt)("th",{parentName:"tr",align:null},"Setting"),(0,n.kt)("th",{parentName:"tr",align:null},"Description"),(0,n.kt)("th",{parentName:"tr",align:null},"Default"))),(0,n.kt)("tbody",{parentName:"table"},(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:null},"crt"),(0,n.kt)("td",{parentName:"tr",align:null},"The property name pointing to the PEM encoded public key certificate in Vault"),(0,n.kt)("td",{parentName:"tr",align:null},"tls.crt")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:null},"key"),(0,n.kt)("td",{parentName:"tr",align:null},"The property name pointing to the private key certificate content in Vault"),(0,n.kt)("td",{parentName:"tr",align:null},"tls.key")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:null},"ca"),(0,n.kt)("td",{parentName:"tr",align:null},"The property name pointing to the CA certificate content in Vault (optional)"),(0,n.kt)("td",{parentName:"tr",align:null},"ca.crt")))))}p.isMDXComponent=!0}}]);