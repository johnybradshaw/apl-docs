"use strict";(self.webpackChunkredkubes_github_io=self.webpackChunkredkubes_github_io||[]).push([[5531],{3905:(e,t,n)=>{n.d(t,{Zo:()=>c,kt:()=>m});var a=n(7294);function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,a,o=function(e,t){if(null==e)return{};var n,a,o={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var s=a.createContext({}),p=function(e){var t=a.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},c=function(e){var t=p(e.components);return a.createElement(s.Provider,{value:t},e.children)},d={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},u=a.forwardRef((function(e,t){var n=e.components,o=e.mdxType,r=e.originalType,s=e.parentName,c=l(e,["components","mdxType","originalType","parentName"]),u=p(n),m=o,g=u["".concat(s,".").concat(m)]||u[m]||d[m]||r;return n?a.createElement(g,i(i({ref:t},c),{},{components:n})):a.createElement(g,i({ref:t},c))}));function m(e,t){var n=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var r=n.length,i=new Array(r);i[0]=u;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l.mdxType="string"==typeof e?e:o,i[1]=l;for(var p=2;p<r;p++)i[p]=n[p];return a.createElement.apply(null,i)}return a.createElement.apply(null,n)}u.displayName="MDXCreateElement"},4348:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>s,contentTitle:()=>i,default:()=>d,frontMatter:()=>r,metadata:()=>l,toc:()=>p});var a=n(7462),o=(n(7294),n(3905));const r={slug:"lab-5",title:"BYO manifest to deploy a workload with Argo CD",sidebar_label:"Lab 5"},i=void 0,l={unversionedId:"for-devs/get-started/lab-5",id:"for-devs/get-started/lab-5",title:"BYO manifest to deploy a workload with Argo CD",description:"Deploying your applications by doing kubectl apply -f is not ideal. You as a developer would like to automatically deploy and update your application after a new build. Otomi integrated Argo CD to provide an out-of-the-box gitops solution.",source:"@site/docs/for-devs/get-started/lab-5.md",sourceDirName:"for-devs/get-started",slug:"/for-devs/get-started/lab-5",permalink:"/docs/for-devs/get-started/lab-5",draft:!1,editUrl:"https://github.com/redkubes/redkubes.github.io/tree/main/docs/for-devs/get-started/lab-5.md",tags:[],version:"current",frontMatter:{slug:"lab-5",title:"BYO manifest to deploy a workload with Argo CD",sidebar_label:"Lab 5"},sidebar:"mainSidebar",previous:{title:"Lab 4",permalink:"/docs/for-devs/get-started/lab-4"},next:{title:"Lab 6",permalink:"/docs/for-devs/get-started/lab-6"}},s={},p=[{value:"Using Argo CD to deploy manifests and charts",id:"using-argo-cd-to-deploy-manifests-and-charts",level:2}],c={toc:p};function d(e){let{components:t,...r}=e;return(0,o.kt)("wrapper",(0,a.Z)({},c,r,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("p",null,"Deploying your applications by doing ",(0,o.kt)("inlineCode",{parentName:"p"},"kubectl apply -f")," is not ideal. You as a developer would like to automatically deploy and update your application after a new build. Otomi integrated Argo CD to provide an out-of-the-box gitops solution."),(0,o.kt)("h2",{id:"using-argo-cd-to-deploy-manifests-and-charts"},"Using Argo CD to deploy manifests and charts"),(0,o.kt)("p",null,"In the apps section in Otomi console, you'll see an app called Argo CD. Click on it."),(0,o.kt)("p",null,(0,o.kt)("img",{alt:"kubecfg",src:n(9530).Z,width:"2334",height:"1170"})),(0,o.kt)("p",null,"In Argo CD you'll see that an Argo app has already been created for your team. This app is configured to synchronize any manifest that is in the created repo in Gitea for Argo."),(0,o.kt)("p",null,(0,o.kt)("img",{alt:"kubecfg",src:n(5396).Z,width:"2328",height:"1264"})),(0,o.kt)("p",null,"If you click on the app and then click on ",(0,o.kt)("inlineCode",{parentName:"p"},"APP DETAILS"),", you'll see the ",(0,o.kt)("inlineCode",{parentName:"p"},"REPO URL")," and also that the ",(0,o.kt)("inlineCode",{parentName:"p"},"SYNC POLICY")," is set to ",(0,o.kt)("inlineCode",{parentName:"p"},"ENABLE AUTO-SYNC"),"."),(0,o.kt)("p",null,"Go back to the console and click on the Gitea app in the apps section. In the list of repo's you'll now see a new repo called ",(0,o.kt)("inlineCode",{parentName:"p"},"otomi/team-<name>-argocd"),"."),(0,o.kt)("p",null,(0,o.kt)("img",{alt:"kubecfg",src:n(2195).Z,width:"2322",height:"1100"})),(0,o.kt)("p",null,"To show the power of Argo CD, let's add a manifest to the repo and see what happens."),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Create a new file in the repo called ",(0,o.kt)("inlineCode",{parentName:"li"},"deploy-nginx.yaml")," "),(0,o.kt)("li",{parentName:"ul"},"Add the following contents to the file:")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: nginx\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: nginx\n  template:\n    metadata:\n      annotations:\n        policy.otomi.io/ignore-sidecar: container-limits,psp-allowed-users\n      labels:\n        app: nginx\n    spec:\n      containers:\n        - name: nginx\n          image: nginxinc/nginx-unprivileged:stable\n          resources:\n            limits:\n              memory: '128Mi'\n              cpu: '200m'\n            requests:\n              memory: '64Mi'\n              cpu: '100m'\n          securityContext:\n            runAsUser: 1001\n          ports:\n            - containerPort: 8080\n---\napiVersion: v1\nkind: Service\nmetadata:\n  name: nginx\nspec:\n  selector:\n    app: nginx\n  ports:\n    - port: 80\n      targetPort: 8080\n")),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Commit Changes")),(0,o.kt)("p",null,"Now go back to the Argo app and click on the ",(0,o.kt)("inlineCode",{parentName:"p"},"team<name>")," application. You can see that all the Kubernetes resources have been created."),(0,o.kt)("p",null,(0,o.kt)("img",{alt:"kubecfg",src:n(7753).Z,width:"2328",height:"1334"})))}d.isMDXComponent=!0},5396:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/argo-team-app-bf528e566f14e5b932c3e6b19d576bd7.png"},2195:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/argo-team-repo-8e32c2e3934576878bc6351475ac8db6.png"},7753:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/argo-team-sync-17ef01cdd07ce5828cdbc2943dd49105.png"},9530:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/team-app-argo-83b9f3c3776b747ab761c3003202913d.png"}}]);