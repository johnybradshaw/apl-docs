"use strict";(self.webpackChunkredkubes_github_io=self.webpackChunkredkubes_github_io||[]).push([[1391],{3905:function(e,t,r){r.d(t,{Zo:function(){return u},kt:function(){return m}});var n=r(7294);function a(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function o(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function c(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?o(Object(r),!0).forEach((function(t){a(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):o(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function s(e,t){if(null==e)return{};var r,n,a=function(e,t){if(null==e)return{};var r,n,a={},o=Object.keys(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||(a[r]=e[r]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}var i=n.createContext({}),l=function(e){var t=n.useContext(i),r=t;return e&&(r="function"==typeof e?e(t):c(c({},t),e)),r},u=function(e){var t=l(e.components);return n.createElement(i.Provider,{value:t},e.children)},p={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},d=n.forwardRef((function(e,t){var r=e.components,a=e.mdxType,o=e.originalType,i=e.parentName,u=s(e,["components","mdxType","originalType","parentName"]),d=l(r),m=a,f=d["".concat(i,".").concat(m)]||d[m]||p[m]||o;return r?n.createElement(f,c(c({ref:t},u),{},{components:r})):n.createElement(f,c({ref:t},u))}));function m(e,t){var r=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var o=r.length,c=new Array(o);c[0]=d;var s={};for(var i in t)hasOwnProperty.call(t,i)&&(s[i]=t[i]);s.originalType=e,s.mdxType="string"==typeof e?e:a,c[1]=s;for(var l=2;l<o;l++)c[l]=r[l];return n.createElement.apply(null,c)}return n.createElement.apply(null,r)}d.displayName="MDXCreateElement"},3856:function(e,t,r){r.r(t),r.d(t,{frontMatter:function(){return s},contentTitle:function(){return i},metadata:function(){return l},toc:function(){return u},default:function(){return d}});var n=r(7462),a=r(3366),o=(r(7294),r(3905)),c=["components"],s={slug:"console/secrets",title:"Secrets"},i=void 0,l={unversionedId:"ui-secrets",id:"ui-secrets",title:"Secrets",description:"Console: new secret",source:"@site/docs/ui-secrets.md",sourceDirName:".",slug:"/console/secrets",permalink:"/docs/console/secrets",editUrl:"https://github.com/redkubes/redkubes.github.io/tree/master/docs/ui-secrets.md",tags:[],version:"current",frontMatter:{slug:"console/secrets",title:"Secrets"},sidebar:"mainSidebar",previous:{title:"Jobs",permalink:"/docs/console/team-jobs"},next:{title:"Team Settings",permalink:"/docs/console/team-settings"}},u=[{value:"Create a Generic secret",id:"create-a-generic-secret",children:[],level:3},{value:"Create a Docker Registry secret",id:"create-a-docker-registry-secret",children:[],level:3},{value:"Create a TLS secret",id:"create-a-tls-secret",children:[],level:3}],p={toc:u};function d(e){var t=e.components,s=(0,a.Z)(e,c);return(0,o.kt)("wrapper",(0,n.Z)({},p,s,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("p",null,(0,o.kt)("img",{alt:"Console: new secret",src:r(8825).Z,width:"2664",height:"1474"})),(0,o.kt)("p",null,"Any secret that is created here should have it's counterpart in Vault by the same name. Otomi will create kubernetes secrets from those Vault secrets. These can then be used in Otomi Services and Otomi Jobs, as injected env vars, or as file mounts."),(0,o.kt)("p",null,"Otomi supports 3 types of secrets:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"#create-a-generic-secret"},"Create a Generic secret")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"#create-a-docker-registry-secret"},"Create a Docker Registry secret")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"#create-a-tls-secret"},"Create a TLS secret"))),(0,o.kt)("h3",{id:"create-a-generic-secret"},"Create a Generic secret"),(0,o.kt)("p",null,"Create a generic kubernetes secret by listing a selection of (or all) properties of a Vault secret registered with the same name."),(0,o.kt)("h3",{id:"create-a-docker-registry-secret"},"Create a Docker Registry secret"),(0,o.kt)("p",null,'The docker registry (or pull) secret should exist in Vault as a secret with the same name. The vault secret should be of type "json" and have only one property ',(0,o.kt)("inlineCode",{parentName:"p"},".dockerconfigjson"),". Use the following command to create the json:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},'email="not@us.ed" # can be something else if the registry provider expects it, but usually this is ignored\nserver="" # example: "https://harbor.demo.eks.otomi.cloud/"\nusername="" # your username\npassword="" # your password, can be token\nkubectl create secret docker-registry --dry-run=client regcred --docker-email=$email --docker-server=$server --docker-username=$username --docker-password=$password -o jsonpath=\'{.data.\\.dockerconfigjson}\' | base64 --decode\n')),(0,o.kt)("h3",{id:"create-a-tls-secret"},"Create a TLS secret"),(0,o.kt)("p",null,'To create a TLS secret, the fields should correspond with the properties as named in the Vault secret registered with the same name. The "ca" field is optional and can be used to provide the certificate authority (for mTLS).'),(0,o.kt)("table",null,(0,o.kt)("thead",{parentName:"table"},(0,o.kt)("tr",{parentName:"thead"},(0,o.kt)("th",{parentName:"tr",align:null},"Setting"),(0,o.kt)("th",{parentName:"tr",align:null},"Description"),(0,o.kt)("th",{parentName:"tr",align:null},"Default"))),(0,o.kt)("tbody",{parentName:"table"},(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},"crt"),(0,o.kt)("td",{parentName:"tr",align:null},"The property name pointing to the PEM encoded public key certificate in Vault"),(0,o.kt)("td",{parentName:"tr",align:null},"tls.crt")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},"key"),(0,o.kt)("td",{parentName:"tr",align:null},"The property name pointing to the private key certificate content in Vault"),(0,o.kt)("td",{parentName:"tr",align:null},"tls.key")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},"ca"),(0,o.kt)("td",{parentName:"tr",align:null},"The property name pointing to the CA certificate content in Vault (optional)"),(0,o.kt)("td",{parentName:"tr",align:null},"ca.crt")))))}d.isMDXComponent=!0},8825:function(e,t,r){t.Z=r.p+"assets/images/team-secrets-6abb1a8b74c0c98e70af32c8e5444c32.png"}}]);