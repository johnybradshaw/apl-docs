"use strict";(self.webpackChunkredkubes_github_io=self.webpackChunkredkubes_github_io||[]).push([[5018],{8635:(e,t,s)=>{s.r(t),s.d(t,{assets:()=>o,contentTitle:()=>i,default:()=>u,frontMatter:()=>a,metadata:()=>l,toc:()=>c});var n=s(5893),r=s(1151);const a={slug:"custom",title:"Custom",sidebar_label:"Custom"},i="Install Otomi using the custom provider",l={id:"get-started/installation/custom",title:"Custom",description:"To install Otomi on any other cloud or infrastructure platform, use the custom provider in Otomi. Make sure your infrastructure adheres to the following pre-requisites:",source:"@site/docs/get-started/installation/custom.md",sourceDirName:"get-started/installation",slug:"/get-started/installation/custom",permalink:"/docs/get-started/installation/custom",draft:!1,unlisted:!1,editUrl:"https://github.com/redkubes/redkubes.github.io/tree/main/docs/get-started/installation/custom.md",tags:[],version:"current",frontMatter:{slug:"custom",title:"Custom",sidebar_label:"Custom"},sidebar:"mainSidebar",previous:{title:"Civo",permalink:"/docs/get-started/installation/civo"},next:{title:"Digital Ocean",permalink:"/docs/get-started/installation/digitalocean"}},o={},c=[{value:"Kubernetes versions",id:"kubernetes-versions",level:2},{value:"Compute resources",id:"compute-resources",level:2},{value:"Default storage class",id:"default-storage-class",level:2},{value:"External IP",id:"external-ip",level:2},{value:"CNI",id:"cni",level:2},{value:"API certificates",id:"api-certificates",level:2},{value:"Install Otomi using the Helm chart",id:"install-otomi-using-the-helm-chart",level:2}];function d(e){const t={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,r.a)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(t.h1,{id:"install-otomi-using-the-custom-provider",children:["Install Otomi using the ",(0,n.jsx)(t.code,{children:"custom"})," provider"]}),"\n",(0,n.jsxs)(t.p,{children:["To install Otomi on any other cloud or infrastructure platform, use the ",(0,n.jsx)(t.code,{children:"custom"})," provider in Otomi. Make sure your infrastructure adheres to the following pre-requisites:"]}),"\n",(0,n.jsx)(t.h2,{id:"kubernetes-versions",children:"Kubernetes versions"}),"\n",(0,n.jsx)(t.p,{children:"Otomi currently supports the following Kubernetes versions:"}),"\n",(0,n.jsxs)(t.ul,{children:["\n",(0,n.jsx)(t.li,{children:(0,n.jsx)(t.code,{children:"1.25"})}),"\n",(0,n.jsx)(t.li,{children:(0,n.jsx)(t.code,{children:"1.26"})}),"\n",(0,n.jsx)(t.li,{children:(0,n.jsx)(t.code,{children:"1.27"})}),"\n"]}),"\n",(0,n.jsx)(t.h2,{id:"compute-resources",children:"Compute resources"}),"\n",(0,n.jsxs)(t.p,{children:["Otomi requires a node pool with at least ",(0,n.jsx)(t.strong,{children:"8 vCPU"})," and ",(0,n.jsx)(t.strong,{children:"16 GiB RAM"}),". Note that this is the requirements for a minimal install. When activating more apps, you'll probably need more resources."]}),"\n",(0,n.jsx)(t.admonition,{title:"ATTENTION",type:"info",children:(0,n.jsx)(t.p,{children:"The minimal resource requirement to run Otomi is based on running Core Apps only! The core apps provide an advanced ingress architecture based on Nginx, Istio, Keycloak, Oaut2 Proxy and Certmanager. Activating optional apps will require more compute resources. We advise to have a node pool available with 16 vCPU and 24 GiB memory."})}),"\n",(0,n.jsx)(t.h2,{id:"default-storage-class",children:"Default storage class"}),"\n",(0,n.jsx)(t.p,{children:"The custom provider uses the default storage class. If your cluster has a storage class, make sure it is set to be the default:"}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-bash",children:'kubectl patch storageclass ,your-storage-class> -p \'{"metadata": {"annotations":{"storageclass.kubernetes.io/is-default-class":"true"}}}\'\n'})}),"\n",(0,n.jsx)(t.h2,{id:"external-ip",children:"External IP"}),"\n",(0,n.jsx)(t.p,{children:"Otomi needs to be able to create a Kubernetes LoadBalancer Service that obtains an external IP. This IP needs to be accessible from within the cluster. Use Metallb for on-prem installations to allow Otomi to create a LoadBalancer Service:"}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-bash",children:"# Install Metallb with Helm\nkubectl create namespace mlb\nhelm repo add metallb https://metallb.github.io/metallb\nhelm repo update\nhelm install metallb metallb/metallb -n mlb\n\nsleep 60\n# Create the IPAddressPool and L2Advertisement\ncat <<EOF | kubectl apply -f -\napiVersion: metallb.io/v1beta1\nkind: IPAddressPool\nmetadata:\n  name: default-pool\n  namespace: mlb\nspec:\n  addresses:\n  - <start-ip>-<end-ip>\n---\napiVersion: metallb.io/v1beta1\nkind: L2Advertisement\nmetadata:\n  name: default-pool\n  namespace: mlb\nEOF\n"})}),"\n",(0,n.jsx)(t.h2,{id:"cni",children:"CNI"}),"\n",(0,n.jsxs)(t.p,{children:["To use the network policies feature in Otomi, make sure to install the ",(0,n.jsx)(t.a,{href:"https://www.tigera.io/project-calico/",children:"Calico"})," CNI or any other CNI that supports Kubernetes network polices."]}),"\n",(0,n.jsx)(t.p,{children:"Install Tigera Operator:"}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-bash",children:"helm repo add projectcalico https://docs.tigera.io/calico/charts\nhelm repo update\nkubectl create namespace tigera-operator\nhelm install calico projectcalico/tigera-operator --version v3.26.3 --namespace tigera-operator\n"})}),"\n",(0,n.jsx)(t.p,{children:"Or install Calico minimal:"}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-bash",children:"kubectl apply -f https://raw.githubusercontent.com/projectcalico/calico/v3.26.3/manifests/calico.yaml\n"})}),"\n",(0,n.jsx)(t.h2,{id:"api-certificates",children:"API certificates"}),"\n",(0,n.jsxs)(t.p,{children:["If your cluster uses untrusted certificates, make sure to set ",(0,n.jsx)(t.code,{children:"metrics-server"})," for ",(0,n.jsx)(t.code,{children:"kubelet-insecure-tls"}),":"]}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-yaml",children:"apps:\n  metrics-server:\n    extraArgs:\n      kubelet-insecure-tls: true\n      kubelet-preferred-address-types: InternalIP\n"})}),"\n",(0,n.jsx)(t.h2,{id:"install-otomi-using-the-helm-chart",children:"Install Otomi using the Helm chart"}),"\n",(0,n.jsxs)(t.p,{children:["To install Otomi using the ",(0,n.jsx)(t.code,{children:"custom"})," provider, use the following values:"]}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-bash",children:"tee values.yaml<<EOF\ncluster:\n  name: otomi\n  provider: custom\n# optionally configure metrics-server for kubelet-insecure-tls\napps:\n  metrics-server:\n    extraArgs:\n      kubelet-insecure-tls: true\n      kubelet-preferred-address-types: InternalIP\nEOF\n"})}),"\n",(0,n.jsxs)(t.p,{children:["The ",(0,n.jsx)(t.code,{children:"custom"})," Otomi provider can be used in combination with any DNS provider."]})]})}function u(e={}){const{wrapper:t}={...(0,r.a)(),...e.components};return t?(0,n.jsx)(t,{...e,children:(0,n.jsx)(d,{...e})}):d(e)}},1151:(e,t,s)=>{s.d(t,{Z:()=>l,a:()=>i});var n=s(7294);const r={},a=n.createContext(r);function i(e){const t=n.useContext(a);return n.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function l(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:i(e.components),n.createElement(a.Provider,{value:t},e.children)}}}]);