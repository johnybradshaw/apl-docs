"use strict";(self.webpackChunkredkubes_github_io=self.webpackChunkredkubes_github_io||[]).push([[2144],{3905:(e,t,o)=>{o.d(t,{Zo:()=>u,kt:()=>m});var n=o(7294);function i(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}function r(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function a(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?r(Object(o),!0).forEach((function(t){i(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):r(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}function l(e,t){if(null==e)return{};var o,n,i=function(e,t){if(null==e)return{};var o,n,i={},r=Object.keys(e);for(n=0;n<r.length;n++)o=r[n],t.indexOf(o)>=0||(i[o]=e[o]);return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(n=0;n<r.length;n++)o=r[n],t.indexOf(o)>=0||Object.prototype.propertyIsEnumerable.call(e,o)&&(i[o]=e[o])}return i}var s=n.createContext({}),p=function(e){var t=n.useContext(s),o=t;return e&&(o="function"==typeof e?e(t):a(a({},t),e)),o},u=function(e){var t=p(e.components);return n.createElement(s.Provider,{value:t},e.children)},c={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},d=n.forwardRef((function(e,t){var o=e.components,i=e.mdxType,r=e.originalType,s=e.parentName,u=l(e,["components","mdxType","originalType","parentName"]),d=p(o),m=i,f=d["".concat(s,".").concat(m)]||d[m]||c[m]||r;return o?n.createElement(f,a(a({ref:t},u),{},{components:o})):n.createElement(f,a({ref:t},u))}));function m(e,t){var o=arguments,i=t&&t.mdxType;if("string"==typeof e||i){var r=o.length,a=new Array(r);a[0]=d;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l.mdxType="string"==typeof e?e:i,a[1]=l;for(var p=2;p<r;p++)a[p]=o[p];return n.createElement.apply(null,a)}return n.createElement.apply(null,o)}d.displayName="MDXCreateElement"},4394:(e,t,o)=>{o.r(t),o.d(t,{assets:()=>s,contentTitle:()=>a,default:()=>c,frontMatter:()=>r,metadata:()=>l,toc:()=>p});var n=o(7462),i=(o(7294),o(3905));const r={slug:"builds",title:"Team Builds",sidebar_label:"Builds"},a=void 0,l={unversionedId:"for-devs/console/builds",id:"for-devs/console/builds",title:"Team Builds",description:"A Build in Otomi is a self-service feature for:",source:"@site/docs/for-devs/console/builds.md",sourceDirName:"for-devs/console",slug:"/for-devs/console/builds",permalink:"/docs/for-devs/console/builds",draft:!1,editUrl:"https://github.com/redkubes/redkubes.github.io/tree/main/docs/for-devs/console/builds.md",tags:[],version:"current",frontMatter:{slug:"builds",title:"Team Builds",sidebar_label:"Builds"},sidebar:"mainSidebar",previous:{title:"Projects",permalink:"/docs/for-devs/console/projects"},next:{title:"Workloads",permalink:"/docs/for-devs/console/workloads"}},s={},p=[{value:"Create a build",id:"create-a-build",level:2},{value:"Docker",id:"docker",level:3},{value:"Buildpacks",id:"buildpacks",level:3},{value:"(optional) Configure repository access",id:"optional-configure-repository-access",level:3}],u={toc:p};function c(e){let{components:t,...o}=e;return(0,i.kt)("wrapper",(0,n.Z)({},u,o,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("p",null,"A Build in Otomi is a self-service feature for:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Building OCI compliant images based on application source code"),(0,i.kt)("li",{parentName:"ul"},"Pushing the image to the teams private registry in Harbor")),(0,i.kt)("admonition",{type:"info"},(0,i.kt)("p",{parentName:"admonition"},"This is a BETA feature. Any feedback on this feature is very much appreciated.")),(0,i.kt)("admonition",{type:"info"},(0,i.kt)("p",{parentName:"admonition"},"Ask you platform administrator to activate Harbor and Tekton to be able to use this feature.")),(0,i.kt)("h2",{id:"create-a-build"},"Create a build"),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},"Enter a name for the build")),(0,i.kt)("p",null,"The name of the build will be used for the registry name of the image (",(0,i.kt)("inlineCode",{parentName:"p"},"harbor.<domainSuffix>/team-name/build-name"),")"),(0,i.kt)("ol",{start:2},(0,i.kt)("li",{parentName:"ol"},"(optional) Adjust the tag")),(0,i.kt)("p",null,"The tag will be used to tag the image  (",(0,i.kt)("inlineCode",{parentName:"p"},"harbor.<domainSuffix>/team-name/build-name:tag"),")"),(0,i.kt)("p",null,"Now choose the type of the build:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Use ",(0,i.kt)("inlineCode",{parentName:"li"},"Docker")," to build an image using the ",(0,i.kt)("inlineCode",{parentName:"li"},"./Dockerfile")," in your code repository"),(0,i.kt)("li",{parentName:"ul"},"Use ",(0,i.kt)("inlineCode",{parentName:"li"},"Buildpacks")," to build an image from application source using Buildpacks")),(0,i.kt)("h3",{id:"docker"},"Docker"),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},"Add the URL of the Git repository that contains the application source code"),(0,i.kt)("li",{parentName:"ol"},"(optional) Change the path of the ",(0,i.kt)("inlineCode",{parentName:"li"},"Dockerfile")),(0,i.kt)("li",{parentName:"ol"},"(optional) Change the revsion. This can be a commit, a tag, or a branch"),(0,i.kt)("li",{parentName:"ol"},"(optional) Configure ",(0,i.kt)("a",{parentName:"li",href:"#optional-configure-repository-access"},"repository access"))),(0,i.kt)("h3",{id:"buildpacks"},"Buildpacks"),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},"Add the URL of the Git repository that contains the application source code"),(0,i.kt)("li",{parentName:"ol"},"(optional) Add the path. This is a subpath within the repo where the source to build is located"),(0,i.kt)("li",{parentName:"ol"},"(optional) Change the revsion. This can be a commit, a tag, or a branch"),(0,i.kt)("li",{parentName:"ol"},"(optional) Configure ",(0,i.kt)("a",{parentName:"li",href:"#optional-configure-repository-access"},"repository access"))),(0,i.kt)("h3",{id:"optional-configure-repository-access"},"(optional) Configure repository access"),(0,i.kt)("admonition",{type:"info"},(0,i.kt)("p",{parentName:"admonition"},"For now, Otomi only supports authenticated access to local Gitea repositories. Otomi will soon also support authenticated access to GitHib repositories.")),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"If Gitea (provided by Otomi) is used to host the code repository, select ",(0,i.kt)("inlineCode",{parentName:"li"},"Otomi Gitea repo"))),(0,i.kt)("p",null,"After a few minutes, Otomi will run a pipeline to create the build and push the build to the team's private Harbor registry. Check Harbor to see if the image is created and pushed."),(0,i.kt)("p",null,"To see the status of the build:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Start/open a shell in the console"),(0,i.kt)("li",{parentName:"ul"},"run the following command:")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"tkn pipelineruns list\ntkn pipelinerun logs <pipelinerun-name> -f\n")),(0,i.kt)("p",null,"Build can be restarted by changing the ",(0,i.kt)("inlineCode",{parentName:"p"},"tag")," of the build or by restarting the pipeline manually:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Start/open a shell in the console"),(0,i.kt)("li",{parentName:"ul"},"run the following command:")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"tkn pipelines list\ntkn pipeline start <pipeline-name> --use-pipelinerun <pipelinerun-name>\n")))}c.isMDXComponent=!0}}]);