"use strict";(self.webpackChunkredkubes_github_io=self.webpackChunkredkubes_github_io||[]).push([[5914],{5165:(e,a,s)=>{s.r(a),s.d(a,{assets:()=>i,contentTitle:()=>d,default:()=>h,frontMatter:()=>r,metadata:()=>o,toc:()=>l});var n=s(5893),t=s(1151);const r={slug:"lab-30",title:"Create custom dashboards",sidebar_label:"Create custom dashboards"},d=void 0,o={id:"get-started/labs/lab-30",title:"Create custom dashboards",description:"In the lab Using custom metrics we created a Workload with a ServiceMonitor so the Team's Prometheus can scrape our custom metrics. In this lab we are going to create a custom Grafana dashboard and add the dashboard to a Configmap so the Team's Grafana will automatically load the dashboard.",source:"@site/docs/get-started/labs/lab-30.md",sourceDirName:"get-started/labs",slug:"/get-started/labs/lab-30",permalink:"/docs/get-started/labs/lab-30",draft:!1,unlisted:!1,editUrl:"https://github.com/redkubes/redkubes.github.io/tree/main/docs/get-started/labs/lab-30.md",tags:[],version:"current",frontMatter:{slug:"lab-30",title:"Create custom dashboards",sidebar_label:"Create custom dashboards"},sidebar:"mainSidebar",previous:{title:"Using custom metrics",permalink:"/docs/get-started/labs/lab-22"},next:{title:"Create custom rules",permalink:"/docs/get-started/labs/lab-31"}},i={},l=[{value:"Create a dashboard in Grafana",id:"create-a-dashboard-in-grafana",level:2},{value:"Make the dashboard persistent",id:"make-the-dashboard-persistent",level:2}];function c(e){const a={a:"a",code:"code",h2:"h2",img:"img",li:"li",ol:"ol",p:"p",pre:"pre",...(0,t.a)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(a.p,{children:["In the lab ",(0,n.jsx)(a.a,{href:"/docs/get-started/labs/lab-22",children:"Using custom metrics"})," we created a Workload with a ServiceMonitor so the Team's Prometheus can scrape our custom metrics. In this lab we are going to create a custom Grafana dashboard and add the dashboard to a Configmap so the Team's Grafana will automatically load the dashboard."]}),"\n",(0,n.jsx)(a.h2,{id:"create-a-dashboard-in-grafana",children:"Create a dashboard in Grafana"}),"\n",(0,n.jsxs)(a.ol,{children:["\n",(0,n.jsxs)(a.li,{children:["\n",(0,n.jsxs)(a.p,{children:["In the left menu, click on ",(0,n.jsx)(a.code,{children:"Apps"})," and open ",(0,n.jsx)(a.code,{children:"Grafana"})]}),"\n"]}),"\n",(0,n.jsxs)(a.li,{children:["\n",(0,n.jsx)(a.p,{children:"Go to the Grafana dashboard homepage"}),"\n"]}),"\n",(0,n.jsxs)(a.li,{children:["\n",(0,n.jsxs)(a.p,{children:["In the top right click on ",(0,n.jsx)(a.code,{children:"New"})," and then ",(0,n.jsx)(a.code,{children:"New Dashboard"})]}),"\n"]}),"\n",(0,n.jsxs)(a.li,{children:["\n",(0,n.jsxs)(a.p,{children:["Click ",(0,n.jsx)(a.code,{children:"+ Add visualization"})]}),"\n"]}),"\n",(0,n.jsxs)(a.li,{children:["\n",(0,n.jsxs)(a.p,{children:["In the ",(0,n.jsx)(a.code,{children:"Query"})," tab select ",(0,n.jsx)(a.code,{children:"Prometheus (default)"})]}),"\n"]}),"\n",(0,n.jsxs)(a.li,{children:["\n",(0,n.jsxs)(a.p,{children:["In the ",(0,n.jsx)(a.code,{children:"A"})," collapsible section, select a metric from the ",(0,n.jsx)(a.code,{children:"Metric"})," drop-down list. In our example we use the ",(0,n.jsx)(a.code,{children:"application_greetings_total"})," metric"]}),"\n"]}),"\n",(0,n.jsxs)(a.li,{children:["\n",(0,n.jsxs)(a.p,{children:["Click ",(0,n.jsx)(a.code,{children:"Run queries"})]}),"\n"]}),"\n",(0,n.jsxs)(a.li,{children:["\n",(0,n.jsxs)(a.p,{children:["You should now see a ",(0,n.jsx)(a.code,{children:"Time series"})," graph like this:"]}),"\n"]}),"\n"]}),"\n",(0,n.jsx)(a.p,{children:(0,n.jsx)(a.img,{alt:"dashboards",src:s(9695).Z+"",width:"3390",height:"2384"})}),"\n",(0,n.jsxs)(a.ol,{start:"9",children:["\n",(0,n.jsx)(a.li,{children:"Save the dashboard in Grafana"}),"\n"]}),"\n",(0,n.jsx)(a.h2,{id:"make-the-dashboard-persistent",children:"Make the dashboard persistent"}),"\n",(0,n.jsx)(a.p,{children:"You know know how to create a dashboard in Grafana using custom metrics. You could now save the dashboard, but if Grafana would get re-started, the dashboard would be gone. To make the dashboard persistent we need to add it to a configmap."}),"\n",(0,n.jsxs)(a.ol,{children:["\n",(0,n.jsxs)(a.li,{children:["Go to ",(0,n.jsx)(a.code,{children:"apps"})," and open ",(0,n.jsx)(a.code,{children:"Gitea"})]}),"\n",(0,n.jsxs)(a.li,{children:["In the list of repositories there is a repository called ",(0,n.jsx)(a.code,{children:"otomi/team-<team-name>-argocd"}),". Go to this repository."]}),"\n",(0,n.jsxs)(a.li,{children:["Click ",(0,n.jsx)(a.code,{children:"Add File"})," and then ",(0,n.jsx)(a.code,{children:"New File"})]}),"\n",(0,n.jsxs)(a.li,{children:["Name the file ",(0,n.jsx)(a.code,{children:"my-custom-dashboard.yaml"})]}),"\n",(0,n.jsx)(a.li,{children:"Add the following manifest to the file:"}),"\n"]}),"\n",(0,n.jsx)(a.pre,{children:(0,n.jsx)(a.code,{className:"language-yaml",children:'apiVersion: v1\nkind: ConfigMap\nmetadata:\n  name: my-custom-dashboard\n  labels:\n    grafana_dashboard: "1"\n    release: grafana-dashboards-labs # change labs to the name of your team\ndata:\n  my-dashboard.json: |-\n    # paste your dashboard json here\n'})}),"\n",(0,n.jsxs)(a.ol,{start:"6",children:["\n",(0,n.jsx)(a.li,{children:"Before commiting changes, go back to Grafana"}),"\n",(0,n.jsxs)(a.li,{children:["Click on ",(0,n.jsx)(a.code,{children:"Dashboard settings"})," (in the top right)"]}),"\n",(0,n.jsxs)(a.li,{children:["In the left menu click ",(0,n.jsx)(a.code,{children:"JSON model"})]}),"\n",(0,n.jsx)(a.li,{children:"Copy the JSON model and paste it into the ConfigMap. Make sure to indent with 4"}),"\n",(0,n.jsx)(a.li,{children:"Delete the dashboard created in Grafana"}),"\n",(0,n.jsx)(a.li,{children:"Commit changes in Gitea"}),"\n"]}),"\n",(0,n.jsx)(a.p,{children:"The dashboard will now automatically be loaded into Grafana."})]})}function h(e={}){const{wrapper:a}={...(0,t.a)(),...e.components};return a?(0,n.jsx)(a,{...e,children:(0,n.jsx)(c,{...e})}):c(e)}},9695:(e,a,s)=>{s.d(a,{Z:()=>n});const n=s.p+"assets/images/dashboards-1-1fea3cea5c85e3ebdd5b5fd545054f02.png"},1151:(e,a,s)=>{s.d(a,{Z:()=>o,a:()=>d});var n=s(7294);const t={},r=n.createContext(t);function d(e){const a=n.useContext(r);return n.useMemo((function(){return"function"==typeof e?e(a):{...a,...e}}),[a,e])}function o(e){let a;return a=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:d(e.components),n.createElement(r.Provider,{value:a},e.children)}}}]);