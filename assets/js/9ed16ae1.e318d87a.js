"use strict";(self.webpackChunkredkubes_github_io=self.webpackChunkredkubes_github_io||[]).push([[7896],{3521:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>r,contentTitle:()=>o,default:()=>d,frontMatter:()=>l,metadata:()=>a,toc:()=>c});var s=n(5893),i=n(1151);const l={slug:"helm",title:"Helm",sidebar_label:"Helm"},o="Install Otomi with Helm",a={id:"get-started/installation/helm",title:"Helm",description:"Add the Otomi repository",source:"@site/docs/get-started/installation/helm.md",sourceDirName:"get-started/installation",slug:"/get-started/installation/helm",permalink:"/docs/get-started/installation/helm",draft:!1,unlisted:!1,editUrl:"https://github.com/redkubes/redkubes.github.io/tree/main/docs/get-started/installation/helm.md",tags:[],version:"current",frontMatter:{slug:"helm",title:"Helm",sidebar_label:"Helm"},sidebar:"mainSidebar",previous:{title:"Vultr",permalink:"/docs/get-started/installation/vultr"},next:{title:"Known Issues",permalink:"/docs/get-started/installation/known-issues"}},r={},c=[{value:"Add the Otomi repository",id:"add-the-otomi-repository",level:2},{value:"Minimal configuration",id:"minimal-configuration",level:2},{value:"Custom values",id:"custom-values",level:2},{value:"Install the Chart",id:"install-the-chart",level:2},{value:"Monitoring the chart install",id:"monitoring-the-chart-install",level:2},{value:"Installing from source",id:"installing-from-source",level:2},{value:"Download source",id:"download-source",level:3},{value:"Install",id:"install",level:3},{value:"Uninstalling Otomi",id:"uninstalling-otomi",level:2}];function h(e){const t={a:"a",admonition:"admonition",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",p:"p",pre:"pre",...(0,i.a)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(t.h1,{id:"install-otomi-with-helm",children:"Install Otomi with Helm"}),"\n",(0,s.jsx)(t.h2,{id:"add-the-otomi-repository",children:"Add the Otomi repository"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-bash",children:"helm repo add otomi https://otomi.io/otomi-core\nhelm repo update\n"})}),"\n",(0,s.jsxs)(t.p,{children:["See ",(0,s.jsx)(t.a,{href:"https://helm.sh/docs/helm/helm_repo/",children:"helm repo"})," for command documentation."]}),"\n",(0,s.jsx)(t.h2,{id:"minimal-configuration",children:"Minimal configuration"}),"\n",(0,s.jsx)(t.admonition,{type:"info",children:(0,s.jsxs)(t.p,{children:["As of version ",(0,s.jsx)(t.a,{href:"https://github.com/redkubes/otomi-core/releases/tag/v0.21.0",children:"1.0.0"})," Otomi supports Kubernetes versions ",(0,s.jsx)(t.code,{children:"1.25"}),",",(0,s.jsx)(t.code,{children:"1.26"})," and ",(0,s.jsx)(t.code,{children:"1.27"}),"."]})}),"\n",(0,s.jsx)(t.admonition,{type:"info",children:(0,s.jsxs)(t.p,{children:["The Otomi ",(0,s.jsx)(t.a,{href:"/docs/for-devs/console/builds",children:"Builds"})," and ",(0,s.jsx)(t.a,{href:"/docs/for-devs/console/projects",children:"Projects"})," features and using Harbor for private registries is NOT supported when Otomi is installed with minimal configuration. Install Otomi with DNS to use all Otomi features."]})}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-yaml",children:"cluster:\n  name: # the name of your cluster\n  provider: # choose between aws, azure, google, digitalocean, ovh, vultr, scaleway or custom\n"})}),"\n",(0,s.jsxs)(t.p,{children:["When the chart is installed, follow the ",(0,s.jsx)(t.a,{href:"/docs/get-started/activation",children:"activation steps"}),"."]}),"\n",(0,s.jsx)(t.h2,{id:"custom-values",children:"Custom values"}),"\n",(0,s.jsxs)(t.p,{children:["To view the required ",(0,s.jsx)(t.code,{children:"values.yaml"})," file with detailed comments, view and download the chart's latest ",(0,s.jsx)(t.a,{href:"https://github.com/redkubes/otomi-core/blob/main/chart/otomi/values.yaml",children:"values.yaml"}),". Run the following command to view ",(0,s.jsx)(t.em,{children:"all"})," the values (which might be overwhelming):"]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-bash",children:"helm show values otomi/otomi\n"})}),"\n",(0,s.jsx)(t.p,{children:"To test wether the input values are correct run the following command:"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-bash",children:"helm template -f values.yaml otomi/otomi\n"})}),"\n",(0,s.jsx)(t.h2,{id:"install-the-chart",children:"Install the Chart"}),"\n",(0,s.jsx)(t.p,{children:"Install the chart with the following command:"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-bash",children:"helm install -f values.yaml otomi otomi/otomi\n"})}),"\n",(0,s.jsx)(t.h2,{id:"monitoring-the-chart-install",children:"Monitoring the chart install"}),"\n",(0,s.jsxs)(t.p,{children:["The chart deploys a Job (",(0,s.jsx)(t.code,{children:"otomi"}),") in the ",(0,s.jsx)(t.code,{children:"default"})," namespace. Monitor the chart install using ",(0,s.jsx)(t.code,{children:"kubectl"}),":"]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-bash",children:"# get the status of the job\nkubectl get job otomi -w\n# watch the helm chart install status:\nwatch helm list -Aa\n"})}),"\n",(0,s.jsxs)(t.p,{children:["Or view detailed info about kubernetes resources with ",(0,s.jsx)(t.a,{href:"https://k9scli.io",children:"k9s"})]}),"\n",(0,s.jsxs)(t.p,{children:["When the chart is installed, follow the ",(0,s.jsx)(t.a,{href:"/docs/get-started/activation",children:"activation steps"})]}),"\n",(0,s.jsx)(t.h2,{id:"installing-from-source",children:"Installing from source"}),"\n",(0,s.jsxs)(t.p,{children:["As an alternative, you can also clone the otomi-core source code from the ",(0,s.jsx)(t.a,{href:"https://github.com/redkubes/otomi-core",children:"Github"})," and install otomi using the chart source code."]}),"\n",(0,s.jsx)(t.h3,{id:"download-source",children:"Download source"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-bash",children:"git clone https://github.com/redkubes/otomi-core.git\ncd otomi-core\n"})}),"\n",(0,s.jsxs)(t.p,{children:["Before installing the chart from source, first change the ",(0,s.jsx)(t.code,{children:"CHART_VERSION_PLACEHOLDER"})," in the ",(0,s.jsx)(t.code,{children:"chart/otomi/Chart.yaml"})," to ",(0,s.jsx)(t.code,{children:"v1.0.0"})]}),"\n",(0,s.jsx)(t.h3,{id:"install",children:"Install"}),"\n",(0,s.jsxs)(t.p,{children:["Now customize the ",(0,s.jsx)(t.code,{children:"values.yaml"})," file. Make sure to set the version to the branch you like to use:"]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{children:"otomi:\n  version: main\n"})}),"\n",(0,s.jsxs)(t.p,{children:["Use the following command to install the chart with the name ",(0,s.jsx)(t.code,{children:"my-otomi-release"})," (a custom name that you choose)."]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-bash",children:"helm install -f values.yaml my-otomi-release chart/otomi\n"})}),"\n",(0,s.jsx)(t.h2,{id:"uninstalling-otomi",children:"Uninstalling Otomi"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-bash",children:"helm uninstall my-otomi-release\n"})}),"\n",(0,s.jsx)(t.p,{children:"Doing a Helm uninstall will remove all Helm releases deployed by Otomi. After uninstalling, some namespaces created by Otomi can stay in a Terminating status. To remove all namespaces in a Terminating status, run the following command:"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{children:"for ns in $(kubectl get ns --field-selector status.phase=Terminating -o jsonpath='{.items[*].metadata.name}'); do kubectl get ns $ns -ojson | jq '.spec.finalizers = []' | kubectl replace --raw \"/api/v1/namespaces/$ns/finalize\" -f -; done\n"})})]})}function d(e={}){const{wrapper:t}={...(0,i.a)(),...e.components};return t?(0,s.jsx)(t,{...e,children:(0,s.jsx)(h,{...e})}):h(e)}},1151:(e,t,n)=>{n.d(t,{Z:()=>a,a:()=>o});var s=n(7294);const i={},l=s.createContext(i);function o(e){const t=s.useContext(l);return s.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function a(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:o(e.components),s.createElement(l.Provider,{value:t},e.children)}}}]);