"use strict";(self.webpackChunkredkubes_github_io=self.webpackChunkredkubes_github_io||[]).push([[8168],{6013:(e,s,t)=>{t.r(s),t.d(s,{assets:()=>l,contentTitle:()=>c,default:()=>h,frontMatter:()=>r,metadata:()=>d,toc:()=>i});var a=t(5893),n=t(1151);const r={slug:"lab-34",title:"Use Sealed Secrets",sidebar_label:"Use Sealed Secrets"},c=void 0,d={id:"get-started/labs/lab-34",title:"Use Sealed Secrets",description:"In this lab we will create sealed secrets and see how to securely sensitive information in git repository.",source:"@site/docs/get-started/labs/lab-34.md",sourceDirName:"get-started/labs",slug:"/get-started/labs/lab-34",permalink:"/docs/get-started/labs/lab-34",draft:!1,unlisted:!1,editUrl:"https://github.com/redkubes/redkubes.github.io/tree/main/docs/get-started/labs/lab-34.md",tags:[],version:"current",frontMatter:{slug:"lab-34",title:"Use Sealed Secrets",sidebar_label:"Use Sealed Secrets"},sidebar:"mainSidebar",previous:{title:"Create secrets in Vault",permalink:"/docs/get-started/labs/lab-8"},next:{title:"Explore the Catalog",permalink:"/docs/get-started/labs/lab-29"}},l={},i=[{value:"Enabling Sealed Secrets",id:"enabling-sealed-secrets",level:2},{value:"Creating a Sealed Secret",id:"creating-a-sealed-secret",level:2},{value:"Checking the repository",id:"checking-the-repository",level:2},{value:"Checking the cluster",id:"checking-the-cluster",level:2}];function o(e){const s={code:"code",h2:"h2",img:"img",p:"p",pre:"pre",...(0,n.a)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(s.p,{children:"In this lab we will create sealed secrets and see how to securely sensitive information in git repository."}),"\n",(0,a.jsx)(s.h2,{id:"enabling-sealed-secrets",children:"Enabling Sealed Secrets"}),"\n",(0,a.jsxs)(s.p,{children:["As an ",(0,a.jsx)(s.code,{children:"Admin"})," go to the ",(0,a.jsx)(s.code,{children:"Apps"})," panel and activate ",(0,a.jsx)(s.code,{children:"sealed-secrets"}),", afterwards click the ",(0,a.jsx)(s.code,{children:"deploy"})," button.\nIf you are not and ",(0,a.jsx)(s.code,{children:"Admin"})," then ask your ",(0,a.jsx)(s.code,{children:"Admin"})," to enable the ",(0,a.jsx)(s.code,{children:"sealed-secrets"})," application."]}),"\n",(0,a.jsx)(s.h2,{id:"creating-a-sealed-secret",children:"Creating a Sealed Secret"}),"\n",(0,a.jsxs)(s.p,{children:["To create a sealed secret, on the team overview click on the ",(0,a.jsx)(s.code,{children:"Sealed Secrets"})," in the sidebar and select the ",(0,a.jsx)(s.code,{children:"Create SealedSecret"}),". This will take you to the page where you can create a sealed secret."]}),"\n",(0,a.jsx)(s.p,{children:(0,a.jsx)(s.img,{alt:"Sealed secrets",src:t(1218).Z+"",width:"1689",height:"1183"})}),"\n",(0,a.jsxs)(s.p,{children:["To configure the sealed secret fill in a name for your secret and the desired namespace.\nAfterwards you can add the ",(0,a.jsx)(s.code,{children:"secret"})," data that you want to store in the sealed secret.\nThe secret data is stored as 'key' 'value'. In the example below we created a secret named 'secret-credentials' in the namespace 'team-demo'.\nThe secret has the key values ",(0,a.jsx)(s.code,{children:"password=helloworld"})," and ",(0,a.jsx)(s.code,{children:"username=labs-user"}),". Now click on ",(0,a.jsx)(s.code,{children:"submit"})," and ",(0,a.jsx)(s.code,{children:"Deploy Changes"}),"."]}),"\n",(0,a.jsx)(s.p,{children:(0,a.jsx)(s.img,{alt:"Create sealed secret",src:t(5132).Z+"",width:"1693",height:"1184"})}),"\n",(0,a.jsx)(s.p,{children:"Once the secret is created you cannot see the values anymore."}),"\n",(0,a.jsx)(s.p,{children:(0,a.jsx)(s.img,{alt:"Created sealed secret",src:t(5547).Z+"",width:"1695",height:"1170"})}),"\n",(0,a.jsx)(s.h2,{id:"checking-the-repository",children:"Checking the repository"}),"\n",(0,a.jsxs)(s.p,{children:["Now go to Gitea and check the otomi/values repository. You will see that under ",(0,a.jsx)(s.code,{children:"values/env/teams/sealedsecrets.<team-name>.yaml"})," the secret is stored in yaml, but the values are encrypted."]}),"\n",(0,a.jsx)(s.p,{children:(0,a.jsx)(s.img,{alt:"Repository sealed secret",src:t(8698).Z+"",width:"1714",height:"723"})}),"\n",(0,a.jsx)(s.h2,{id:"checking-the-cluster",children:"Checking the cluster"}),"\n",(0,a.jsx)(s.p,{children:"The only way to see the values of the secret is to have access to the cluster and decrypt the secret. The secrets are there stored as base64 encoded values."}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-bash",children:"kubectl get secret secret-credentials -o yaml -n team-demo\n"})}),"\n",(0,a.jsx)(s.p,{children:"This wil return the secret in yaml format. The values are stored as base64 encoded values."}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-yaml",children:'apiVersion: v1\ndata:\n  password: aGVsbG93b3JsZA==\n  username: bGFicy11c2Vy\nkind: Secret\nmetadata:\n  creationTimestamp: "2024-04-11T14:33:37Z"\n  name: secret-credentials\n  namespace: team-demo\n  ownerReferences:\n  - apiVersion: bitnami.com/v1alpha1\n    controller: true\n    kind: SealedSecret\n    name: secret-credentials\n    uid: 4ead6ffe-f1e9-4b30-91d7-94011af12452\n  resourceVersion: "4085462"\n  uid: 48d84c95-0eb1-47d8-acae-b0d3d7474921\ntype: kubernetes.io/opaque\n'})}),"\n",(0,a.jsx)(s.p,{children:"If you want to decode the secret you can use base64 decode:"}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-bash",children:'kubectl get secret secret-credentials -n team-demo -o jsonpath="{.data.password}" | base64 --decode\nhelloworld\n'})})]})}function h(e={}){const{wrapper:s}={...(0,n.a)(),...e.components};return s?(0,a.jsx)(s,{...e,children:(0,a.jsx)(o,{...e})}):o(e)}},5132:(e,s,t)=>{t.d(s,{Z:()=>a});const a=t.p+"assets/images/create-sealed-secrets-ea2d00d4172ce0f9cda061af1b94d7d3.png"},5547:(e,s,t)=>{t.d(s,{Z:()=>a});const a=t.p+"assets/images/created-sealed-secrets-222adc0516582c875f27eccf475f3193.png"},8698:(e,s,t)=>{t.d(s,{Z:()=>a});const a=t.p+"assets/images/repository-sealed-secrets-6b6ff826474e2f5c6a57cc7510aed318.png"},1218:(e,s,t)=>{t.d(s,{Z:()=>a});const a=t.p+"assets/images/sealed-secrets-e0313a58592caaf3869dc8556eb20a1b.png"},1151:(e,s,t)=>{t.d(s,{Z:()=>d,a:()=>c});var a=t(7294);const n={},r=a.createContext(n);function c(e){const s=a.useContext(r);return a.useMemo((function(){return"function"==typeof e?e(s):{...s,...e}}),[s,e])}function d(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(n):e.components||n:c(e.components),a.createElement(r.Provider,{value:s},e.children)}}}]);